df1 <- read.csv("new_merged_data_4.csv", header = T,
stringsAsFactors = FALSE);
df2 <- read.csv("new_labels.csv", header = T,
stringsAsFactors = FALSE);
# Find rows with the same 'Interaction' but different 'Combined'
diff_rows <- df1 %>%
inner_join(df2, by = "Interaction", suffix = c("_df1", "_df2")) %>%
filter(Combined_df1 != Combined_df2)
View(diff_rows)
write.csv(diff_rows, "differences.csv", row.names = FALSE)
# Cell type annotation
# Veronika Pak
rm(list = ls())
library(braincellann)
# Step 1: Read the CSV file into a data frame
df <- read.csv("/Users/veronikapak/Desktop/genes_with_labels2.csv", header = T)
# Step 1: Read the CSV file into a data frame
df <- read.csv("/Users/veronikapak/benchmarking/genes_with_labels2.csv", header = T)
# Step 1: Read the CSV file into a data frame
df <- read.csv("/Users/veronikapak/Desktop/benchmarking/genes_with_labels2.csv", header = T)
# Step 2: Extract the desired column (e.g., 'column_name')
column_data <- df$Gene
# Step 3: Convert the column to a list
list <- as.list(column_data)
genes <- annotateList(list)
?get_resource
# Load PanglaoDB data using get_resource (assumes this function is defined elsewhere)
data.frame <- get_resource("PanglaoDB")
if (!is.data.frame(panglaoDB)) {
stop("PanglaoDB resource could not be retrieved.")
}
View(data.frame)
library(braincellann)
genes <- annotateList(list)
write.csv(genes, '/Users/veronikapak/Desktop/benchmarking/bench_results_final.csv')
library(braincellann)
genes <- annotateList(list)
View(genes)
library(braincellann)
genes <- annotateList(list)
genes <- annotateList(list)
library(braincellann)
genes <- annotateList(list)
View(genes)
write.csv(genes, '/Users/veronikapak/Desktop/benchmarking/bench_results_final.csv')
library(braincellann)
genes <- annotateList(list)
View(genes)
write.csv(genes, '/Users/veronikapak/Desktop/benchmarking/bench_results_final.csv')
library(braincellann)
genes <- annotateList(list)
View(genes)
library(braincellann)
genes <- annotateList(list)
View(genes)
library(braincellann)
genes <- annotateList(list)
View(genes)
# Step 1: Read the CSV file into a data frame
df <- read.csv("/Users/veronikapak/Desktop/benchmarking/test.csv", header = T)
# Step 2: Extract the desired column (e.g., 'column_name')
column_data <- df$Gene
# Step 3: Convert the column to a list
list <- as.list(column_data)
genes <- annotateList(list)
library(braincellann)
genes <- annotateList(list)
View(genes)
library(braincellann)
genes <- annotateList(list)
library(braincellann)
genes <- annotateList(list)
View(genes)
library(braincellann)
genes <- annotateList(list)
View(genes)
library(braincellann)
genes <- annotateList(list)
library(braincellann)
genes <- annotateList(list)
library(braincellann)
genes <- annotateList(list)
library(braincellann)
genes <- annotateList(list)
View(genes)
# Step 1: Read the CSV file into a data frame
df <- read.csv("/Users/veronikapak/Desktop/benchmarking/genes_with_labels2.csv", header = T)
# Step 2: Extract the desired column (e.g., 'column_name')
column_data <- df$Gene
# Step 3: Convert the column to a list
list <- as.list(column_data)
genes <- annotateList(list)
library(braincellann)
genes <- annotateList(list)
cellmarker_filtered <- cellmarker_db %>%
dplyr::filter(tissue_class == "Brain") %>%
dplyr::rename(markers = marker)
genes <- annotateList(list)
#' Annotate Gene Markers with CellMarker 2.0 Database
#'
#' This function annotates a list of gene markers using the CellMarker 2.0 database.
#'
#' @param df A data frame containing gene markers and an index column.
#' @return A data frame with CellMarker annotations, including columns CellMarker_1 and CellMarker_2.
#'
#' @noRd
annotate_cellmarker <- function(df) {
# Load CellMarker data from package
cellmarker_file <- system.file("extdata", "Cell_marker_Human.xlsx", package = "braincellann")
if (cellmarker_file == "") {
stop("CellMarker data file not found in the package.")
}
cellmarker_db <- readxl::read_excel(cellmarker_file)
cellmarker_filtered <- cellmarker_db %>%
dplyr::filter(tissue_class == "Brain") %>%
dplyr::rename(markers = marker)
# Merge and annotate
cellmarker <- cellmarker_db %>%
filter(tissue_class == "Brain")
cellmarker <- cellmarker %>%
rename(markers = marker)
merged_df <- merge(df, cellmarker, by = "markers", all.x = TRUE)
merged_df <- merged_df[order(merged_df$index), ]
subset <- merged_df %>%
select(markers, index, cell_name)
combined_df <- subset %>%
group_by(index) %>%
summarise(markers = paste(unique(markers), collapse = ", "),
cell_name = paste(unique(cell_name), collapse = ", ")) %>%
separate(cell_name, into = paste0("CellMarker_", 1:2), sep = ",")
annotated_cellmarker <- combined_df[, -which(names(combined_df) == "index")]
return(annotated_cellmarker)
}
genes <- annotateList(list)
library(braincellann)
genes <- annotateList(list)
devtools::document()
getwd()
setwd(/Users/veronikapak/braincellann)
setwd("/Users/veronikapak/braincellann")
getwd()
devtools::document()
library(braincellann)
genes <- annotateList(list)
View(genes)
# Read a gene marker list
setwd("/Users/veronikapak/Desktop/cell cell project/cell type annotation");
setwd("/Users/veronikapak/braincellann")
# Read a gene marker list
setwd("/Users/veronikapak/Desktop/cell cell project/cell type annotation");
file_path <- "/Users/veronikapak/Desktop/cell cell project/cell type annotation/LR-pairs-AHBA.csv";
list <- read.csv(file_path, header = T);
list$index <- seq_len(nrow(list))
ligand <- data.frame(column1 = list$Ligand)
receptor <- data.frame(column2 = list$Receptor)
ligands <- annotateList(ligand)
receptors <- annotateList(receptor)
# Merge ligands and receptors
#merged_df4 <- merge(subset_ligands_test, subset_receptors_test, by = "index")
merged_df_final <- merge(ligands, receptors, by = "index")
merged_df_final <- merge(list, merged_df_final, by = "index")
merged_df_final$index <- as.numeric(merged_df_final$index)
merged_df_final <- merged_df_final[order(merged_df_final$index), ]
merged_df_final <- merged_df_final %>%
mutate(Combined = paste(Consensus.x, Consensus.y, sep = "-"))
merged_df_final <- merged_df_final %>%
mutate(Interaction = paste(Ligand, Receptor, sep = "_"))
library(tibble)
library(dplyr)
library(tidyr)
library(readxl)
merged_df_final <- merged_df_final %>%
mutate(Combined = paste(Consensus.x, Consensus.y, sep = "-"))
merged_df_final <- merged_df_final %>%
mutate(Interaction = paste(Ligand, Receptor, sep = "_"))
label_counts <- table(merged_df_final$Combined)
label_counts_df_final <- as.data.frame(label_counts)
write.csv(merged_df_final, "new_labels.csv", row.names = FALSE)
View(label_counts_df_final)
View(merged_df_final)
library(braincellann)
ligand <- data.frame(column1 = list$Ligand)
receptor <- data.frame(column2 = list$Receptor)
receptors <- annotateList(receptor)
ligands <- annotateList(ligand)
# Merge ligands and receptors
#merged_df4 <- merge(subset_ligands_test, subset_receptors_test, by = "index")
merged_df_final <- merge(ligands, receptors, by = "index")
merged_df_final <- merge(list, merged_df_final, by = "index")
merged_df_final$index <- as.numeric(merged_df_final$index)
merged_df_final <- merged_df_final[order(merged_df_final$index), ]
merged_df_final <- merged_df_final %>%
mutate(Combined = paste(Consensus.x, Consensus.y, sep = "-"))
merged_df_final <- merged_df_final %>%
mutate(Interaction = paste(Ligand, Receptor, sep = "_"))
label_counts <- table(merged_df_final$Combined)
label_counts_df_final <- as.data.frame(label_counts)
View(label_counts_df_final)
# Step 1: Read the CSV file into a data frame
df <- read.csv("/Users/veronikapak/Desktop/benchmarking/genes_with_labels2.csv", header = T)
# Step 2: Extract the desired column (e.g., 'column_name')
column_data <- df$Gene
# Step 3: Convert the column to a list
list <- as.list(column_data)
genes <- annotateList(list)
write.csv(genes, '/Users/veronikapak/Desktop/benchmarking/bench_results_final.csv')
write.csv(merged_df_final, "new_labels.csv", row.names = FALSE)
setwd("/Users/veronikapak/Desktop/cell cell project/");
labels <- read.csv("pls_labels_new.csv", header = T);
df1 <- read.csv("new_merged_data_4.csv", header = T,
stringsAsFactors = FALSE);
df2 <- read.csv("new_labels.csv", header = T,
stringsAsFactors = FALSE);
# Find rows with the same 'Interaction' but different 'Combined'
diff_rows <- df1 %>%
inner_join(df2, by = "Interaction", suffix = c("_df1", "_df2")) %>%
filter(Combined_df1 != Combined_df2)
write.csv(diff_rows, "differences2.csv", row.names = FALSE)
library(braincellann)
ligands <- annotateList(ligand)
receptors <- annotateList(receptor)
# Merge ligands and receptors
#merged_df4 <- merge(subset_ligands_test, subset_receptors_test, by = "index")
merged_df_final <- merge(ligands, receptors, by = "index")
merged_df_final <- merge(list, merged_df_final, by = "index")
merged_df_final$index <- as.numeric(merged_df_final$index)
merged_df_final <- merged_df_final[order(merged_df_final$index), ]
View(merged_df_final)
list <- read.csv(file_path, header = T);
list$index <- seq_len(nrow(list))
merged_df_final <- merge(list, merged_df_final, by = "index")
merged_df_final$index <- as.numeric(merged_df_final$index)
merged_df_final <- merged_df_final[order(merged_df_final$index), ]
merged_df_final <- merged_df_final %>%
mutate(Combined = paste(Consensus.x, Consensus.y, sep = "-"))
merged_df_final <- merged_df_final %>%
mutate(Interaction = paste(Ligand, Receptor, sep = "_"))
label_counts <- table(merged_df_final$Combined)
label_counts_df_final <- as.data.frame(label_counts)
View(label_counts_df_final)
write.csv(merged_df_final, "new_labels.csv", row.names = FALSE)
# Step 1: Read the CSV file into a data frame
df <- read.csv("/Users/veronikapak/Desktop/benchmarking/genes_with_labels2.csv", header = T)
# Step 2: Extract the desired column (e.g., 'column_name')
column_data <- df$Gene
# Step 3: Convert the column to a list
list <- as.list(column_data)
genes <- annotateList(list)
write.csv(genes, '/Users/veronikapak/Desktop/benchmarking/bench_results_final.csv')
ligands <- annotateList(ligand)
receptors <- annotateList(receptor)
# Merge ligands and receptors
#merged_df4 <- merge(subset_ligands_test, subset_receptors_test, by = "index")
merged_df_final <- merge(ligands, receptors, by = "index")
merged_df_final <- merge(list, merged_df_final, by = "index")
merged_df_final$index <- as.numeric(merged_df_final$index)
list <- read.csv(file_path, header = T);
list$index <- seq_len(nrow(list))
merged_df_final <- merge(list, merged_df_final, by = "index")
merged_df_final$index <- as.numeric(merged_df_final$index)
merged_df_final <- merged_df_final[order(merged_df_final$index), ]
merged_df_final <- merged_df_final %>%
mutate(Combined = paste(Consensus.x, Consensus.y, sep = "-"))
merged_df_final <- merged_df_final %>%
mutate(Interaction = paste(Ligand, Receptor, sep = "_"))
label_counts <- table(merged_df_final$Combined)
label_counts_df_final <- as.data.frame(label_counts)
View(label_counts_df_final)
View(merged_df_final)
setwd("/Users/veronikapak/braincellann")
library(braincellann)
ligands <- annotateList(ligand)
library(braincellann)
ligands <- annotateList(ligand)
receptors <- annotateList(receptor)
list <- read.csv(file_path, header = T);
list$index <- seq_len(nrow(list))
# Merge ligands and receptors
#merged_df4 <- merge(subset_ligands_test, subset_receptors_test, by = "index")
merged_df_final <- merge(ligands, receptors, by = "index")
merged_df_final <- merge(list, merged_df_final, by = "index")
merged_df_final$index <- as.numeric(merged_df_final$index)
merged_df_final <- merged_df_final[order(merged_df_final$index), ]
merged_df_final <- merged_df_final %>%
mutate(Combined = paste(Consensus.x, Consensus.y, sep = "-"))
merged_df_final <- merged_df_final %>%
mutate(Interaction = paste(Ligand, Receptor, sep = "_"))
label_counts <- table(merged_df_final$Combined)
label_counts_df_final <- as.data.frame(label_counts)
View(label_counts_df_final)
View(merged_df_final)
View(label_counts_df_final)
library(braincellann)
ligands <- annotateList(ligand)
receptors <- annotateList(receptor)
list <- read.csv(file_path, header = T);
list$index <- seq_len(nrow(list))
# Merge ligands and receptors
#merged_df4 <- merge(subset_ligands_test, subset_receptors_test, by = "index")
merged_df_final <- merge(ligands, receptors, by = "index")
merged_df_final <- merge(list, merged_df_final, by = "index")
merged_df_final$index <- as.numeric(merged_df_final$index)
merged_df_final <- merged_df_final[order(merged_df_final$index), ]
merged_df_final <- merged_df_final %>%
mutate(Combined = paste(Consensus.x, Consensus.y, sep = "-"))
merged_df_final <- merged_df_final %>%
mutate(Interaction = paste(Ligand, Receptor, sep = "_"))
label_counts <- table(merged_df_final$Combined)
label_counts_df_final <- as.data.frame(label_counts)
View(merged_df_final)
write.csv(merged_df_final, "new_labels.csv", row.names = FALSE)
setwd("/Users/veronikapak/Desktop/cell cell project/");
labels <- read.csv("pls_labels_new.csv", header = T);
df1 <- read.csv("new_merged_data_4.csv", header = T,
stringsAsFactors = FALSE);
df2 <- read.csv("new_labels.csv", header = T,
stringsAsFactors = FALSE);
# Find rows with the same 'Interaction' but different 'Combined'
diff_rows <- df1 %>%
inner_join(df2, by = "Interaction", suffix = c("_df1", "_df2")) %>%
filter(Combined_df1 != Combined_df2)
write.csv(diff_rows, "differences2.csv", row.names = FALSE)
View(merged_df_final)
labels <- read.csv("pls_labels_new.csv", header = T);
df1 <- read.csv("new_merged_data_4.csv", header = T,
stringsAsFactors = FALSE);
df2 <- read.csv("new_labels.csv", header = T,
stringsAsFactors = FALSE);
# Find rows with the same 'Interaction' but different 'Combined'
diff_rows <- df1 %>%
inner_join(df2, by = "Interaction", suffix = c("_df1", "_df2")) %>%
filter(Combined_df1 != Combined_df2)
View(diff_rows)
write.csv(merged_df_final, "new_labels.csv", row.names = FALSE)
df2 <- read.csv("new_labels.csv", header = T,
stringsAsFactors = FALSE);
# Find rows with the same 'Interaction' but different 'Combined'
diff_rows <- df1 %>%
inner_join(df2, by = "Interaction", suffix = c("_df1", "_df2")) %>%
filter(Combined_df1 != Combined_df2)
View(diff_rows)
View(diff_rows)
library(braincellann)
ligands <- annotateList(ligand)
receptors <- annotateList(receptor)
list <- read.csv(file_path, header = T);
list$index <- seq_len(nrow(list))
# Merge ligands and receptors
#merged_df4 <- merge(subset_ligands_test, subset_receptors_test, by = "index")
merged_df_final <- merge(ligands, receptors, by = "index")
merged_df_final <- merge(list, merged_df_final, by = "index")
merged_df_final$index <- as.numeric(merged_df_final$index)
merged_df_final <- merged_df_final[order(merged_df_final$index), ]
merged_df_final <- merged_df_final %>%
mutate(Combined = paste(Consensus.x, Consensus.y, sep = "-"))
merged_df_final <- merged_df_final %>%
mutate(Interaction = paste(Ligand, Receptor, sep = "_"))
label_counts <- table(merged_df_final$Combined)
label_counts_df_final <- as.data.frame(label_counts)
View(label_counts_df_final)
write.csv(merged_df_final, "new_labels.csv", row.names = FALSE)
labels <- read.csv("pls_labels_new.csv", header = T);
df1 <- read.csv("new_merged_data_4.csv", header = T,
stringsAsFactors = FALSE);
df2 <- read.csv("new_labels.csv", header = T,
stringsAsFactors = FALSE);
# Find rows with the same 'Interaction' but different 'Combined'
diff_rows <- df1 %>%
inner_join(df2, by = "Interaction", suffix = c("_df1", "_df2")) %>%
filter(Combined_df1 != Combined_df2)
write.csv(diff_rows, "differences2.csv", row.names = FALSE)
View(label_counts_df_final)
library(braincellann)
ligands <- annotateList(ligand)
library(braincellann)
ligands <- annotateList(ligand)
receptors <- annotateList(receptor)
list <- read.csv(file_path, header = T);
list$index <- seq_len(nrow(list))
# Merge ligands and receptors
#merged_df4 <- merge(subset_ligands_test, subset_receptors_test, by = "index")
merged_df_final <- merge(ligands, receptors, by = "index")
library(braincellann)
ligands <- annotateList(ligand)
receptors <- annotateList(receptor)
list <- read.csv(file_path, header = T);
list$index <- seq_len(nrow(list))
# Merge ligands and receptors
#merged_df4 <- merge(subset_ligands_test, subset_receptors_test, by = "index")
merged_df_final <- merge(ligands, receptors, by = "index")
merged_df_final <- merge(list, merged_df_final, by = "index")
merged_df_final$index <- as.numeric(merged_df_final$index)
merged_df_final <- merged_df_final[order(merged_df_final$index), ]
merged_df_final <- merged_df_final %>%
mutate(Combined = paste(Consensus.x, Consensus.y, sep = "-"))
merged_df_final <- merged_df_final %>%
mutate(Interaction = paste(Ligand, Receptor, sep = "_"))
label_counts <- table(merged_df_final$Combined)
label_counts_df_final <- as.data.frame(label_counts)
View(label_counts_df_final)
library(braincellann)
ligands <- annotateList(ligand)
receptors <- annotateList(receptor)
# Merge ligands and receptors
#merged_df4 <- merge(subset_ligands_test, subset_receptors_test, by = "index")
merged_df_final <- merge(ligands, receptors, by = "index")
library(braincellann)
ligands <- annotateList(ligand)
receptors <- annotateList(receptor)
# Merge ligands and receptors
#merged_df4 <- merge(subset_ligands_test, subset_receptors_test, by = "index")
merged_df_final <- merge(ligands, receptors, by = "index")
merged_df_final <- merge(list, merged_df_final, by = "index")
merged_df_final$index <- as.numeric(merged_df_final$index)
merged_df_final <- merged_df_final[order(merged_df_final$index), ]
merged_df_final <- merged_df_final %>%
mutate(Combined = paste(Consensus.x, Consensus.y, sep = "-"))
merged_df_final <- merged_df_final %>%
mutate(Interaction = paste(Ligand, Receptor, sep = "_"))
label_counts <- table(merged_df_final$Combined)
label_counts_df_final <- as.data.frame(label_counts)
View(label_counts_df_final)
write.csv(merged_df_final, "new_labels.csv", row.names = FALSE)
df2 <- read.csv("new_labels.csv", header = T,
stringsAsFactors = FALSE);
# Find rows with the same 'Interaction' but different 'Combined'
diff_rows <- df1 %>%
inner_join(df2, by = "Interaction", suffix = c("_df1", "_df2")) %>%
filter(Combined_df1 != Combined_df2)
write.csv(diff_rows, "differences3.csv", row.names = FALSE)
df <- read.csv("new_labels.csv", header = T,
stringsAsFactors = FALSE);
# Find rows in df1 that don't have matching Interaction values in df2
diff_df1 <- df %>%
filter(!Pair %in% labels$Pair)
View(merged_df_final)
df <- read.csv("new_labels.csv", header = T,
stringsAsFactors = FALSE);
# Find rows in df1 that don't have matching Interaction values in df2
diff_df1 <- df %>%
filter(!Pair %in% labels$Pair)
View(diff_df1)
# Find rows in df2 that don't have matching Interaction values in df1
diff_df2 <- labels %>%
filter(!Pair %in% df$Interaction)
View(diff_df2)
filtered_df <- diff_df1 %>%
filter(Ligand != Receptor)
View(filtered_df)
View(labels)
write.csv(filtered_df, "new_pairs.csv", row.names = FALSE)
# Combine the differences
diff_all <- bind_rows(diff_df1, diff_df2)
diff_rows <- df %>%
inner_join(labels_updated, by = "Pair", suffix = c("_df1", "_df2")) %>%
filter(Interaction_df1 != Interaction_df2)
df <- read.csv("new_labels.csv", header = T,
stringsAsFactors = FALSE);
# Find rows in df1 that don't have matching Interaction values in df2
diff_df1 <- df %>%
filter(!Pair %in% labels$Pair)
View(diff_df1)
View(label_counts_df_final)
df <- read.csv("new_labels.csv", header = T,
stringsAsFactors = FALSE);
# Find rows in df1 that don't have matching Interaction values in df2
diff_df1 <- df %>%
filter(!Pair %in% labels$Pair)
View(diff_df1)
# Find rows in df2 that don't have matching Interaction values in df1
diff_df2 <- labels %>%
filter(!Pair %in% df$Interaction)
filtered_df <- diff_df1 %>%
filter(Ligand != Receptor)
View(filtered_df)
# Find rows in df2 that don't have matching Interaction values in df1
diff_df2 <- labels %>%
filter(!Pair %in% df$Pair)
View(diff_df2)
# Combine the differences
diff_all <- bind_rows(diff_df1, diff_df2)
diff_rows <- df %>%
inner_join(labels_updated, by = "Pair", suffix = c("_df1", "_df2")) %>%
filter(Interaction_df1 != Interaction_df2)
diff_rows <- df %>%
inner_join(labels, by = "Pair", suffix = c("_df1", "_df2")) %>%
filter(Interaction_df1 != Interaction_df2)
labels_updated <- labels %>%
left_join(df %>% select(Pair, Interaction), by = "Pair", suffix = c("", "_df")) %>%
mutate(Interaction = ifelse(!is.na(Interaction_df), Interaction_df, Interaction)) %>%
select(-Interaction_df)
labels_updated <- labels %>%
left_join(df %>% select(Pair, Pair), by = "Pair", suffix = c("", "_df")) %>%
mutate(Pair = ifelse(!is.na(Pair_df), Pair_df, Pair)) %>%
select(-Pair_df)
diff_rows <- df %>%
inner_join(labels, by = "Pair", suffix = c("_df1", "_df2")) %>%
filter(Pair_df1 != Pair_df2)
labels <- read.csv("pls_labels_new.csv", header = T);
label_counts <- table(labels$Interaction)
label_counts_df3 <- as.data.frame(label_counts)
View(label_counts_df3)
View(label_counts_df3)
View(label_counts_df_final)
View(diff_df2)
View(df)
filtered_df <- diff_df1 %>%
filter(Ligand != Receptor)
View(filtered_df)
write.csv(filtered_df, "new_pairs.csv", row.names = FALSE)
View(filtered_df)
View(diff_df2)
